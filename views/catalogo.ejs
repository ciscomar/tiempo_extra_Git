<%- include ("./static/header") %>
  <%- include ("./static/sidebar") %>
    <%- include ("./static/navbar") %>

      <div class="container-fluid">
        <div class="row mt-5">

          <div class="col-auto" style="margin: 0 auto">


          </div>

          <div class="col-4">
            <img src="/img/TristoneLogo.png" class="img-logo rounded mx-auto d-block" alt="Tristone Flowtech">
            <h1 class="display-5 text-center csvTitulo">Catalogo
            </h1>

            <p class="lead text-center"></p>
          </div>
          <div class="col-auto" style="margin: 0 auto">

          </div>

        </div>

      </div>








      <div class="container-fluid mt-4">
        <div class="card text-center" id="cardExcel">
          <h5 class="card-header bg-dark text-white"><span class="text-success fas fa-file-excel"> </span>
            Carga archivo excel</h5>
          <div class="card-body">

            <form  name="myForm" action="/" method="post" enctype="multipart/form-data" onsubmit="event.preventDefault(); sendData();">
              <div class="form-group ">
                  <div class="row">
                      <div class="text-center col" id="insert_excel">
                          <div class="box">
                              <input id="excelFile" name="excelFile" type="file"
                                  accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet">
                              <label for="excelFile"></label>
                          </div>
                          <br>
                          <div class="form-group text-center col">
                              <input id="btn_excel" type="submit" formaction="/insertar_catalogo"
                                  class="btn btn-success  btn-sm btn-block animate__animated animate__flipOutX"
                                  disabled></input>
                          </div>

                      </div>
                  </div>
              </div>
          </form>



          



          <div class="modal fade" id="modalSpinner" tabindex="-1" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header text-center">
                        <h2 class="modal-title "> <span class="text-secondary  fas fa-stopwatch"></span>
                            Procesando archivo</h2>
                        <div class="spinner-grow spinner-grow-sm text-warning mt-4 cdelay-1" role="status">
                            <span class="sr-only">Loading...</span>
                        </div>
                        <div class="spinner-grow spinner-grow-sm text-primary mt-4 cdelay-2" role="status">
                            <span class="sr-only">Loading...</span>
                        </div>
                        <div class="spinner-grow spinner-grow-sm text-secondary mt-4 cdelay-3" role="status">
                            <span class="sr-only">Loading...</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
          

        <div class="modal fade" id="modalSuccess" tabindex="-1" role="dialog" aria-labelledby="modelTitleId"
                aria-hidden="true">
                <div class="modal-dialog modal-dialog-scrollable" role="document">
                    <div class="modal-content">
                        <div class="modal-header card-mov">
                            <img src="/img/TristoneLogo.png" alt="SAP" srcset="" class="card-mov">
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            </button>
                        </div>
                        <div class="modal-body">
                            <div class="row">
                                <div class="col-2">
                                    <i class="fas fa-check-circle text-success" style="font-size: 2rem;"> </i>
                                </div>
                                <div class="col">
                                    <h5>Catalogo Actualizado</h5>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button id="modal_btnCerrar_Error" type="button" class="btn btn-secondary btnCerrar"
                                data-dismiss="modal">Cerrar
                            </button>

                        </div>
                        
                    </div>
                </div>
            </div>



            <div class="modal fade" id="modalError" tabindex="-1" role="dialog" aria-labelledby="modelTitleId"
                aria-hidden="true">
                <div class="modal-dialog modal-dialog-scrollable" role="document">
                    <div class="modal-content">
                        <div class="modal-header card-mov text-center">
                            <img src="/img/TristoneLogo.png" alt="SAP" srcset="" class="card-mov">
                            <!-- <button type="button" class="close" data-dismiss="modal" aria-label="Close"></button> -->
                        </div>
                        <div class="modal-body">
                            <div class="row">
                                <div class="col-lg-12 text-center">
                                    <h4 id="modal_errorText2" ><span
                                            class="fas fa-exclamation-circle text-danger"></span><span
                                            id="modal_errorText"></span></h4>
                                </div>
                            </div>

                        </div>
                        <div class="modal-footer">
                            <button id="modal_btnCerrar_Error" type="button" class="btn btn-secondary btnCerrar"
                                data-dismiss="modal">Cerrar
                            </button>

                        </div>
                    </div>
                </div>
            </div>


          </div>
        </div>


      </div>



      <div class="col text-center mt-2 mb-2">
        <button class="btn btn-success"  id="btnExcelDownload"><span
            class="fas fa-file-excel 2x"></span> Descargar</button>
    </div>






      <div class="container-fluid">
        <div class="card bg-light  ">
            <div class=" card-header text-white bg-secondary text-center">Catalogo Actual</div>
            <div class="card-body">
                <div id="showData" class="mt-3"></div>
                <div class="table-responsive">
                <table id="myTable" class="table table-striped  table-responsive">
                    <thead>
                        <tr>
                            <th>EMP_ID</th>
                            <th>EMP_ACTIVO</th>
                            <th>EMP_NOMBRE</th>
                            <th>EMP_CORREO</th>
                            <th>EMP_ALIAS</th>
                            <th>EMP_FECHA_INGRESO</th>
                            <th>EMP_GENERO</th>
                            <th>EMP_CATEGORIA</th>
                            <th>EMP_ID_JEFE</th>
                            <th>EMP_TURNO</th>
                            <th>EMP_AREA</th>
                        </tr>
                        </thead>
                        <tbody>
    
                        </tbody>
                </table>
            </div>
            </div>
        </div>
    </div>




      <%- include ("./static/guia") %>

        <%- include ("./static/footer") %>
          <script src="/js/functions/catalogo.js"></script>